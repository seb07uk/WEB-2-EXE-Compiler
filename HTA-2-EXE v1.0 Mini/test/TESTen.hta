<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>polsoft.ITS™ HTA – test</title>

    <HTA:APPLICATION
        ID="polsoftITS_HTA_Test"
        APPLICATIONNAME="polsoft.ITS HTA Test"
        BORDER="thin"
        BORDERSTYLE="normal"
        CAPTION="yes"
        ICON="mshta.exe"
        MAXIMIZEBUTTON="yes"
        MINIMIZEBUTTON="yes"
        SHOWINTASKBAR="yes"
        SINGLEINSTANCE="no"
        SYSMENU="yes"
        SCROLL="no"
        WINDOWSTATE="normal">
    </HTA:APPLICATION>

    <style>
        body {
            font-family: Segoe UI, Arial, sans-serif;
            background: #111827;
            color: #e5e7eb;
            margin: 0;
            padding: 20px;
        }
        h1 {
            margin-top: 0;
            color: #38bdf8;
        }
        .card {
            background: #020617;
            border: 1px solid #1f2937;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        button {
            padding: 6px 14px;
            border-radius: 4px;
            border: 1px solid #38bdf8;
            background: #0f172a;
            color: #e5e7eb;
            cursor: pointer;
        }
        button:hover {
            background: #0369a1;
        }
        .log {
            font-family: Consolas, monospace;
            font-size: 11px;
            background: #020617;
            border-radius: 4px;
            border: 1px solid #1f2937;
            padding: 8px;
            height: 120px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>

    <script language="javascript">
        function log(msg) {
            var box = document.getElementById("logBox");
            var now = new Date().toLocaleTimeString();
            box.innerText += "[" + now + "] " + msg + "\r\n";
            box.scrollTop = box.scrollHeight;
        }

        function testAlert() {
            alert("HTA is working correctly.");
            log("testAlert() called");
        }

        function showEnv() {
            try {
                var wsh = new ActiveXObject("WScript.Shell");
                var username = wsh.ExpandEnvironmentStrings("%USERNAME%");
                var computer = wsh.ExpandEnvironmentStrings("%COMPUTERNAME%");
                log("User: " + username + " | Computer: " + computer);
            } catch (e) {
                log("ActiveX error: " + e.message);
            }
        }

        function closeApp() {
            log("Closing HTA.");
            window.close();
        }

        window.onload = function () {
            log("HTA loaded. Ready.");
        };
    </script>
</head>

<body>
    <h1>polsoft.ITS™ – HTA test (UTF-8)</h1>

    <div class="card">
        <b>Information:</b><br>
        This test file checks:
        <ul>
            <li>JavaScript execution,</li>
            <li>ActiveX support,</li>
            <li>event logging.</li>
        </ul>
    </div>

    <div class="card">
        <button onclick="testAlert()">Test alert</button>
        <button onclick="showEnv()">Show environment variables</button>
        <button onclick="closeApp()">Close</button>
    </div>

    <div class="card">
        <b>Event log:</b>
        <div id="logBox" class="log"></div>
    </div>
</body>
</html>
